(window["webpackJsonpguodada-react-blog"]=window["webpackJsonpguodada-react-blog"]||[]).push([[10],{692:function(e,t,n){"use strict";var a=n(32),r=n.n(a),c=n(693),i=n.n(c);r.a.extend(i.a),t.a=r.a},693:function(e,t,n){e.exports=function(){"use strict";return function(e,t,n){e=e||{};var a=t.prototype,r={future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};n.en.relativeTime=r;var c=function(t,a,c,i){for(var s,o,l,m=c.$locale().relativeTime||r,u=e.thresholds||[{l:"s",r:44,d:"second"},{l:"m",r:89},{l:"mm",r:44,d:"minute"},{l:"h",r:89},{l:"hh",r:21,d:"hour"},{l:"d",r:35},{l:"dd",r:25,d:"day"},{l:"M",r:45},{l:"MM",r:10,d:"month"},{l:"y",r:17},{l:"yy",d:"year"}],d=u.length,f=0;f<d;f+=1){var p=u[f];p.d&&(s=i?n(t).diff(c,p.d,!0):c.diff(t,p.d,!0));var y=(e.rounding||Math.round)(Math.abs(s));if(l=s>0,y<=p.r||!p.r){y<=1&&f>0&&(p=u[f-1]);var h=m[p.l];o="string"==typeof h?h.replace("%d",y):h(y,a,p.l,l);break}}return a?o:(l?m.future:m.past).replace("%s",o)};a.to=function(e,t){return c(e,t,this,!0)},a.from=function(e,t){return c(e,t,this)};var i=function(e){return e.$u?n.utc():n()};a.toNow=function(e){return this.to(i(this),e)},a.fromNow=function(e){return this.from(i(this),e)}}}()},696:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n(23),r=n(0);function c(){var e=Object(r.useState)(!1),t=Object(a.a)(e,2),n=t[0],c=t[1];return[n,function(e){if(e instanceof Promise)return new Promise((function(t,n){c(!0),e.then((function(e){t(e),c(!1)})).catch((function(e){n(e),c(!1)}))}))}]}},698:function(e,t,n){},703:function(e,t,n){"use strict";n(671);var a=n(673),r=(n(216),n(71)),c=(n(113),n(62)),i=(n(217),n(76)),s=(n(91),n(19)),o=n(23),l=(n(90),n(26)),m=(n(58),n(3)),u=(n(359),n(128)),d=(n(112),n(54)),f=n(0),p=n.n(f),y=(n(698),n(29)),h=(n(20),n(45)),E=n(40),b=n(84),I=n(696),v=(n(65),n(125),n(42)),g=(n(672),n(674)),j=n(127),O=n(692),C=n(219),L=d.a.TextArea;function k(e){var t=e.children,n=e.item,r=e.userInfo,c=e.articleId,s=e.commentId,u=e.replyId,d=e.replyVisible,y=n.user,b=Object(f.useState)(""),I=Object(o.a)(b,2),k=I[0],w=I[1];function N(){if(!r.userId)return i.a.warn("\u60a8\u672a\u767b\u9646\uff0c\u8bf7\u767b\u5f55\u540e\u518d\u8bd5\u3002");h.a.post("/discuss",{userId:r.userId,articleId:c,content:k.trim(),commentId:s}).then((function(t){e.onReply({commentId:0,replyId:0}),e.setCommentList(t.rows)}))}return Object(f.useEffect)((function(){d&&w("")}),[d]),p.a.createElement(a.a,{actions:[p.a.createElement("span",{onClick:function(){e.onReply({commentId:s,replyId:u})}},"Reply to"),p.a.createElement(p.a.Fragment,null,1===r.role&&p.a.createElement(g.a,{title:"\u662f\u5426\u5220\u9664\u8be5\u7559\u8a00\uff1f",cancelText:"\u53d6\u6d88",okText:"\u786e\u8ba4",onConfirm:function(){u?h.a.delete("/discuss/reply/".concat(u)).then((function(){var t=Object(j.a)(e.commentList),n=t.find((function(e){return e.id===s}));n.replies=n.replies.filter((function(e){return e.id!==u})),e.setCommentList(t)})):h.a.delete("/discuss/comment/".concat(s)).then((function(){var t=Object(j.a)(e.commentList);t=t.filter((function(e){return e.id!==s})),e.setCommentList(t)}))}},p.a.createElement(m.a,{type:"delete",className:"icon-delete"})))],author:p.a.createElement("span",null,y&&y.username),avatar:p.a.createElement(C.a,{userInfo:y}),content:p.a.createElement("div",{className:"article-detail",dangerouslySetInnerHTML:{__html:Object(E.g)(n.content,!0)}}),datetime:p.a.createElement(v.a,{title:n.createdAt},p.a.createElement("span",null,Object(O.a)(n.createdAt).fromNow()))},d&&p.a.createElement("div",{className:"reply-form"},p.a.createElement(L,{placeholder:"\u56de\u590d".concat(n.user.username,"..."),value:k,onChange:function(e){w(e.target.value)},onKeyUp:function(e){e.ctrlKey&&13===e.keyCode&&N()}}),p.a.createElement("div",{className:"reply-form-controls"},p.a.createElement("span",{className:"tip"},"Ctrl or \u2318 + Enter"),p.a.createElement(l.a,{htmlType:"submit",type:"primary",disabled:!k.trim(),onClick:N},"\u56de\u590d"))),t)}var w=function(e){var t=Object(y.useSelector)((function(e){return e.user})),n=e.commentList,a=e.articleId,r=Object(f.useState)({commentId:0,replyId:0}),c=Object(o.a)(r,2),i=c[0],s=c[1];return p.a.createElement("div",{className:"discuss-list"},n.map((function(n){return p.a.createElement(k,{item:n,key:n.id,articleId:a,userInfo:t,commentId:n.id,setCommentList:e.setCommentList,commentList:e.commentList,onReply:s,replyVisible:i.commentId===n.id&&!i.replyId},n.replies.map((function(r){return p.a.createElement(k,{item:r,key:r.id,articleId:a,userInfo:t,commentId:n.id,replyId:r.id,setCommentList:e.setCommentList,commentList:e.commentList,onReply:s,replyVisible:i.commentId===n.id&&i.replyId===r.id})})))})))},N=n(61),M=d.a.TextArea,S=function(e){var t=e.onChange,n=e.onSubmit,a=e.submitting,r=e.value,c=e.articleId;return p.a.createElement("div",null,p.a.createElement(u.a.Item,null,p.a.createElement(M,{rows:4,placeholder:"\u8bf4\u70b9\u4ec0\u4e48...",onChange:t,value:r})),p.a.createElement(u.a.Item,null,p.a.createElement("div",{className:"controls"},p.a.createElement(m.a,{type:"info-circle",className:"controls-tip-icon"}),p.a.createElement("span",{className:"controls-tip"},"\u652f\u6301 Markdown \u8bed\u6cd5"),p.a.createElement(l.a,{className:"disscus-btn",htmlType:"submit",loading:a,onClick:n,type:"primary"},-1!==c?"\u6dfb\u52a0\u8bc4\u8bba":"\u7559\u8a00"))))};t.a=function(e){var t=Object(y.useDispatch)(),n=Object(N.b)(),l=Object(y.useSelector)((function(e){return e.user})),u=l.username,d=(l.role,e.commentList),v=e.articleId,g=Object(f.useState)(""),j=Object(o.a)(g,2),O=j[0],L=j[1],k=Object(I.a)(),M=Object(o.a)(k,2),x=M[0],T=M[1];function R(e){switch(e.key){case"login":n.emit("openSignModal","login");break;case"register":n.emit("openSignModal","register");break;case"loginout":t(Object(b.b)())}}return p.a.createElement("div",{id:"discuss"},p.a.createElement("div",{className:"discuss-header"},p.a.createElement("span",{className:"discuss-count"},Object(E.a)(d)),-1!==v?"\u6761\u8bc4\u8bba":"\u6761\u7559\u8a00",p.a.createElement("span",{className:"discuss-user"},p.a.createElement(c.a,{overlay:u?p.a.createElement(s.a,{onClick:R},p.a.createElement(s.a.Item,{key:"loginout"},"\u6ce8\u9500")):p.a.createElement(s.a,{onClick:R},p.a.createElement(s.a.Item,{key:"login"},"\u767b\u5f55"),p.a.createElement(s.a.Item,{key:"register"},"\u6ce8\u518c")),trigger:["click","hover"]},p.a.createElement("span",null,u||"\u672a\u767b\u5f55\u7528\u6237"," ",p.a.createElement(m.a,{type:"down"})))),p.a.createElement(r.a,{className:"hr"})),p.a.createElement(a.a,{avatar:u?p.a.createElement(C.a,{userInfo:l}):p.a.createElement(m.a,{type:"github",theme:"filled",style:{fontSize:40,margin:"5px 5px 0 0"}}),content:p.a.createElement(S,{onChange:function(e){return L(e.target.value)},onSubmit:function(){if(O)return l.username?void T(h.a.post("/discuss",{articleId:e.articleId,content:O,userId:l.userId})).then((function(t){L(""),e.setCommentList(t.rows)})):i.a.warn("\u60a8\u672a\u767b\u9646\uff0c\u8bf7\u767b\u5f55\u540e\u518d\u8bd5\u3002")},submitting:x,value:O,articleId:v})}),p.a.createElement(w,{commentList:d,articleId:v,setCommentList:e.setCommentList}))}},721:function(e,t,n){},746:function(e,t,n){"use strict";n.r(t);n(364);var a=n(294),r=n(23),c=n(0),i=n.n(c),s=(n(721),n(20)),o=n(45),l=n(703),m=n(165);t.default=function(e){var t=Object(c.useState)([]),n=Object(r.a)(t,2),u=n[0],d=n[1],f=Object(m.useMediaQuery)({query:"(max-width: 576px)"});return Object(c.useEffect)((function(){s.a.discuss&&o.a.get("/article/-1").then((function(e){d(e.comments)}))}),[]),i.a.createElement("div",{className:"app-about",style:{paddingRight:f?0:20}},i.a.createElement(a.a,{src:s.g.avatar}),i.a.createElement("span",{style:{paddingLeft:10}},s.a.describe),s.a.renderMyInfo||null,s.a.discuss&&i.a.createElement(l.a,{articleId:-1,commentList:u,setCommentList:d}))}}}]);